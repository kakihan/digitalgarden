---
{"dg-publish":true,"permalink":"/LLM/角色定义清晰度/如何优化MAS中的智能体的角色定义？/"}
---

## 任务解决
任务解决导向的多智能体系统采用自动智能体合作解决复杂问题。领域前沿研究围绕三大领域：促进智能体间交流，设计高效交互框架，探索智能体如何随时间协同进化。
![Pasted image 20250408083625.png](/img/user/photo/Pasted%20image%2020250408083625.png)
## 社会模拟
社会模拟导向的多智能体系统聚焦建模和分析智能体的社交行为，提供人类动力学领域的洞见，增强分析与预测社会现象的能力。
![Pasted image 20250408090021.png](/img/user/photo/Pasted%20image%2020250408090021.png)
## 多智能体系统问题 
![Pasted image 20250411165215.png](/img/user/photo/Pasted%20image%2020250411165215.png)
ChatDev (Qian et al., 2023) 模拟了一个多代理软件公司 ,其中不同的代理具有不同的角色规范,如CEO、CTO、软件工程师和审查员,他们尝试协作解决软件生成任务。采用完善特定角色的提示,以加强层级和角色遵循。例如,观察到CPO在没有完全解决约束的情况下 过早结束与CEO的讨论。为防止这种情况,确保只有上级代理可以结束对话。此外,我们增强了角色规范,以专注于任务特定的边缘案例。

![Pasted image 20250406205954.png](/img/user/LLM/%E8%A7%92%E8%89%B2%E5%AE%9A%E4%B9%89%E6%B8%85%E6%99%B0%E5%BA%A6%E6%95%B4%E5%90%88/photo/Pasted%20image%2020250406205954.png)![Pasted image 20250406210020.png](/img/user/LLM/%E8%A7%92%E8%89%B2%E5%AE%9A%E4%B9%89%E6%B8%85%E6%99%B0%E5%BA%A6%E6%95%B4%E5%90%88/photo/Pasted%20image%2020250406210020.png)![Pasted image 20250406210034.png](/img/user/photo/Pasted%20image%2020250406210034.png)![Pasted image 20250406210050.png](/img/user/photo/Pasted%20image%2020250406210050.png)![Pasted image 20250406210103.png](/img/user/photo/Pasted%20image%2020250406210103.png)![Pasted image 20250406210129.png](/img/user/photo/Pasted%20image%2020250406210129.png)![Pasted image 20250406210142.png](/img/user/photo/Pasted%20image%2020250406210142.png)
论文通过完善特定角色的提示，来增强角色规范，解决不遵守MAS中部不遵守角色规范的问题。
那什么是角色规范或者说角色定义？
## 什么是角色定义？
## 狭义角度

>*在**任务解决**导向的特定场景多智能体系统中，用以描述智能体在此任务中起什么作用并如何具体起作用的文本。（Prompt）*

>*在**社会模拟**导向的特定场景多智能体系统中，用以描述智能体在此模拟中起什么作用并如何具体起作用的文本。*（Prompt）
### 组成
- (背景)：(流程)场景设置（ChatDev AI Hospital Doctor to Collabrate in Discussion）、
- (身份)：角色名称
- (职责) ：为完成任务，角色操作的覆盖范围（粗粒度，自主度高框架出现）
- (可使用工具)？
- (协作方式)：与谁进行及如何进行合作，
task instruction:
- Task Instruction:（细粒度）
	- 任务定义/{任务定义}
	- (注意事项)
	- (例子)
	- ({任务模板与提示信息})
	- 输出要求
- 当这个Agent较为通用，可以处理领域下的一系列不同任务，任务定义可能是用户提出的不同问题需求，任务要求多变，此时这个任务定义是可以被传进的一个参数。（ChatDev角色）易出现越权问题。
- 当这个Agent较为特化，被设定为解决特定一个任务，那么任务要求固定。（AI Hospital Medical Director to Evaluate）
- 当模型为完成任务需要上下文信息，任务所需信息也被传入。
- **()内容为可选，{}内容为传参，**

狭义角度上来说，一个Agent所执行的任务或在执行某一系列不同任务中的职责，决定其角色。
其作用有三：
- 特化模型能力，提升任务表现
- 构建流程，促进自动化，减少人工干预（自主度高框架，易越权）
- 使用大模型能力完成特定任务，返回格式化输出。
## 广义角度
从AI Agent定义出发：
> “Agent是由大语言模型驱动的自主代理，具备三大核心功能——**规划、行动和记忆**。”
> ——Lilian Weng

这里给出大语言模型语境下，AI Agent的一个定义：
> **能够感知环境，能独立做出决策并能主动执行行动的人工智能系统。**

此时角色定义应该为：
*在任意场景下，旨在对于LLM特化身份并扩展能力的一切设定。*
包含：
- 角色提示词
- 可以使用的函数工具
- 记忆模块的设置
- 感知与通信的能力
- 在多智能体系统拓扑结构中的位置

inspired by 平凡师哥
## 角色定义为什么有效？
**因为在超大规模模型上，提示词=挖掘模型预训练的能力。**
（prompt-tuning->少样本学习->零样本学习）
- Prompt的本质是一种对任务的指令；
- Prompt的本质是一种对预训练任务的复用；
- Prompt的本质是一种参数有效性学习；
### Prompt是一种针对任务的指令

**Prompt本质上是对下游任务的指令，可以作为一种信息增强** 。

简单的来说，就是告诉模型需要做什么任务，输出什么内容。上文我们提及到的离散或连续的模板，本质上就是一种对任务的提示。当数据集不同（乃至样本不同）的时候，我们期望模型能够自适应的选择不同的模板，这也相当于说不同的任务会有其对应的提示信息

### 复用预训练目标——实现基于Prompt的统一范式

这些任务是预训练目标，本质上是预测被mask的位置的词，在训练时让模型理解语言的上下文信息。之所以设计Template和指令，就是希望在下游任务时能够复用这些预训练的目标，避免引入新的参数而导致过拟合。因此，我们可以将Prompt升华到一个新的高度，即 **Prompt Tuning的本质是复用预训练语言模型在预训练阶段所使用的目标和参数**。

### Prompt的本质是参数有效性学习

根据前文的讲解，我们可以发现，实现Prompt-Tuning只需要考虑如何设计模板或指令，而模型和训练目标则都是复用预训练阶段的，即在整个训练过程中，无须添加任何参数（或只需要添加非常少量的与模板有关的参数），而其他参数都是训练好的。基于这个思想，我们再一次将Prompt升华到更高的层面—— **Prompt的本质是参数有效性学习（Parameter-Efficient Learning，PEL）** 。

**参数有效性训练** ：在参数有效性学习过程中，大模型中只需要指定或额外添加少量的可训练参数，而其余的参数全部冻结，这样可以大大提高模型的训练效率的同时，确保指标不会受到太大影响。
**这些参数有效性学习方法本质上都是插入少量的新的参数，这些新的参数可以对预训练模型起到提示作用，只不过并不是以人类可读的离散的模板形式体现而已** 。

### 面向超大规模模型的Prompt-Tuning

发现只需要设计合适的模板或指令即可以 **实现免参数训练的零样本学习** 。

——知乎

### 我的理解：从训练过程出发

- prompt-tuning：通过在语料数据中添加提示模板，并微调，模型学会了当输入包含提示模板时，他应该如何输出“好的内容”（符合任务（提示模板）的内容），参数也进行相应的变化。测试阶段时，当输入中包含提示模板（甚至跟提示模板相似度较高的文本），由于模型经过训练，参数发生特化改变，模型就会输出比较“好的内容”。
- 少、零样本学习：超大规模的模型已经做了相当于隐式的Prompt-Tuning？所以测试时在提示词中给出某一类任务的样本，本质是强化模型在预训练时，对这一类或多类任务的训练及参数改变对于输出的影响（可能是隐式的），复用预训练阶段在这一任务上所使用的对应目标和参数。零样本就是不去强化这种影响直接测试了。
**也就是说，足够好的prompt，能够去充分挖掘模型能力，使其在某一类任务上表现较好。**
那在MAS中，我们如何去衡量一个角色定义的好坏，清晰或模糊，稳定或不稳定？
## 如何量化角色定义清晰度？

![88fd235e7788ac2ba5ac38177a4d099.png](/img/user/LLM/%E8%A7%92%E8%89%B2%E5%AE%9A%E4%B9%89%E6%B8%85%E6%99%B0%E5%BA%A6%E6%95%B4%E5%90%88/photo/88fd235e7788ac2ba5ac38177a4d099.png)
drafted by 周国玲师姐
### 偏差角度

设某一MAS包含$n$个智能体，$A=\{A_1,A_2,...,A_n\}$，定义一个**权限矩阵**：$$M=\left(m_{ij}\right)\in\left[0,1\right]^{n\times n}$$
其中，$m_{ij}=\frac{A_i对A_j越权次数}{A_i进行响应次数}$，我们把 $m_{ii}$ 叫做智能体的**角色纯度**，$m_{ij}(i\neq j)$为**越权干扰度**。
如果$$\ \epsilon > 0,\ s.t.\ \Vert M-I \Vert_F\leq\epsilon$$则说明角色定义清晰。

定义一个MAS中的**角色定义清晰度**：$$C\left(M\right)=\frac{1}{1+\Vert M-I \Vert_F}\in(0,1]$$当角色定义清晰，系统中无越权行为发生时，$M=I$，$\Vert M-I \Vert_F=0$，$C\left(M\right)=1$，当系统中有越权行为发生时，$M\neq I$，$\Vert M-I \Vert_F>0$，$C\left(M\right)<1$.
### 鲁棒性角度

定义一个映射$f:D\rightarrow Y$，当系统被分配任务时，MAS内不同智能体的定义$D$会影响任务的成功率，$Y$是衡量任务成功的指标。

当角色的定义发生扰动$\Delta D$后，如果$$\Vert f(M+\Delta M)-f(M)\Vert \leq \Vert \Delta M\Vert_1=\epsilon$$则说明角色定义鲁棒。
## 如何通过指标自动优化角色定义？
（RePrompt，GPO……）
## 实验设计
（……）